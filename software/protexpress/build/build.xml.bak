<!-- *********************************************************************** -->
<!-- ** PROJECT:   protExpress                                                ** -->
<!-- *********************************************************************** -->
<project name="protexpress" default="build" basedir="..">
	<!-- ******************************************************************* -->
	<!-- ** PROPERTIES                                                    ** -->
	<!-- ******************************************************************* -->
	<!-- Main -->
	<property name="build.dir" value="${basedir}/build"/>
	<property name="lib.dir" value="${basedir}/lib"/>
	<property name="resource.dir" value="${build.dir}/resources"/>
	<property name="target.dir" value="${build.dir}/target"/>
	<property name="site.dir" value="${build.dir}/site"/>
	<property name="webapp.name" value="protExpress"/>
	<!-- Properties for protexpress-common -->
	<property name="protexpress-common.dir" value="${basedir}/protexpress-common"/>
	<property name="protexpress-common.src.dir" value="${protexpress-common.dir}/src/main/java"/>
	<property name="protexpress-common.resources.dir" value="${protexpress-common.dir}/src/main/resources"/>
	<property name="protexpress-common.test.src.dir" value="${protexpress-common.dir}/src/test/java"/>
	<property name="protexpress-common.target.dir" value="${protexpress-common.dir}/target"/>
	<property name="protexpress-common.classes.dir" value="${protexpress-common.target.dir}/classes"/>
	<property name="protexpress-common.instrumented.classes.dir" value="${protexpress-common.target.dir}/instrumented-classes"/>
	<property name="protexpress-common.test.classes.dir" value="${protexpress-common.target.dir}/test-classes"/>
	<property name="protexpress-common.jar" value="${protexpress-common.target.dir}/protexpress-common.jar"/>
	<!-- Properties for protexpress-web -->
	<property name="protexpress-web.dir" value="${basedir}/protexpress-web"/>
	<property name="protexpress-web.src.dir" value="${protexpress-web.dir}/src/main/java"/>
	<property name="protexpress-web.webapp.dir" value="${protexpress-web.dir}/src/main/webapp"/>
	<property name="protexpress-web.test.src.dir" value="${protexpress-web.dir}/src/test/java"/>
	<property name="protexpress-web.target.dir" value="${protexpress-web.dir}/target"/>
	<property name="protexpress-web.classes.dir" value="${protexpress-web.target.dir}/classes"/>
	<property name="protexpress-web.instrumented.classes.dir" value="${protexpress-web.target.dir}/instrumented-classes"/>
	<property name="protexpress-web.test.classes.dir" value="${protexpress-web.target.dir}/test-classes"/>
	<property name="protexpress-web.war" value="${protexpress-web.target.dir}/protexpress.war"/>
	<!-- Third-party Jars-->
	<!--asm -->
	<property name="asm.jar" value="${lib.dir}/asm/asm.jar"/>
	<property name="asm.jar" value="${lib.dir}/asm/asm-3.0.jar"/>
	<property name="asm-attrs.jar" value="${lib.dir}/asm/asm-attrs.jar"/>
	<!-- axis -->
	<property name="axis.jar" value="${lib.dir}/axis/axis.jar"/>
	<property name="jaxrpc.jar" value="${lib.dir}/axis/jaxrpc.jar"/>
	<property name="saaj.jar" value="${lib.dir}/axis/saaj.jar"/>
	<property name="wsdl4j.jar" value="${lib.dir}/axis/wsdl4j-1.5.1.jar"/>
	<!-- codestyle -->
	<property name="checkstyle.jar" value="${lib.dir}/codestyle/checkstyle-all-4.3.jar"/>
	<property name="pmd.jar" value="${lib.dir}/codestyle/pmd-3.9.jar"/>
	<!-- commons -->
	<property name="commons-collections.jar" value="${lib.dir}/commons/commons-collections-3.1.jar"/>
	<property name="commons-lang.jar" value="${lib.dir}/commons/commons-lang-2.1.jar"/>
	<property name="commons-logging.jar" value="${lib.dir}/commons/commons-logging-1.1.jar"/>
	<property name="commons-beanutils.jar" value="${lib.dir}/commons/commons-beanutils-1.7.0.jar"/>
	<property name="commons-codec.jar" value="${lib.dir}/commons/commons-codec-1.3.jar"/>
	<property name="commons-digester.jar" value="${lib.dir}/commons/commons-digester-1.6.jar"/>
	<property name="commons-discovery.jar" value="${lib.dir}/commons/commons-discovery-0.2.jar"/>
	<property name="commons-el.jar" value="${lib.dir}/commons/commons-el-1.0.jar"/>
	<!-- JSF -->
	<property name="myfaces-api.jar" value="${lib.dir}/jsf/myfaces-api-1.1.5.jar"/>
	<property name="myfaces-api-impl.jar" value="${lib.dir}/jsf/myfaces-impl-1.1.5.jar"/>
	<!-- Hibernate -->
	<property name="hibernate.jar" value="${lib.dir}/hibernate/hibernate-3.2.4.sp1.jar"/>
	<property name="hibernate-annotations.jar" value="${lib.dir}/hibernate/hibernate-annotations-3.3.0.GA.jar"/>
	<property name="hibernate-em.jar" value="${lib.dir}/hibernate/hibernate-entitymanager-3.3.1.GA.jar"/>
	<property name="hibernate-validator.jar" value="${lib.dir}/hibernate/hibernate-validator-3.0.0.GA.jar"/>
	<!-- Spring -->
	<property name="spring.jar" value="${lib.dir}/spring/spring-framework-2.0.6.jar"/>
	<property name="cglib.jar" value="${lib.dir}/spring/cglib-2.1.3.jar"/>
	<!-- Test -->
	<property name="cobertura.jar" value="${lib.dir}/test/cobertura.jar"/>
	<property name="junit.jar" value="${lib.dir}/test/junit-4.3.1.jar"/>
	<property name="selenium-server.jar" value="${lib.dir}/test/selenium-server.jar"/>
	<property name="selenium-java-client-driver.jar" value="${lib.dir}/test/selenium-java-client-driver.jar"/>
	<property name="selenium-java-client-driver-tests.jar" value="${lib.dir}/test/selenium-java-client-driver-tests.jar"/>
	<!-- Others -->
	<property name="activation.jar" value="${lib.dir}/other/activation.jar"/>
	<property name="antlr.jar" value="${lib.dir}/other/antlr-2.7.6.jar"/>
	<property name="dom4j.jar" value="${lib.dir}/other/dom4j-1.6.1.jar"/>
	<property name="jakarta-oro.jar" value="${lib.dir}/other/jakarta-oro-2.0.8.jar"/>
	<property name="javaee.jar" value="${lib.dir}/other/javaee.jar"/>
	<property name="jta.jar" value="${lib.dir}/other/jta.jar"/>
	<property name="log4j.jar" value="${lib.dir}/other/log4j-1.2.13.jar"/>
	<property name="mail.jar" value="${lib.dir}/other/mail.jar"/>
	<property name="ojdbc14.jar" value="${lib.dir}/other/ojdbc14.jar"/>
	<property name="xercesImpl.jar" value="${lib.dir}/other/xercesImpl.jar"/>
	<property name="xml-apis.jar" value="${lib.dir}/other/xml-apis.jar"/>
	<property name="postgresql.jar" value="${lib.dir}/db/postgresql-8.1-409.jdbc3.jar"/>
	<!-- Test-related properties -->
	<property name="test.dir" value="${basedir}/test"/>
	<property name="test.target.dir" value="${test.dir}/target"/>
	<property name="test.src.dir" value="${test.dir}/src/test/java"/>
	<property name="test.classes.dir" value="${test.target.dir}/test-classes"/>
	<path id="cobertura.classpath">
		<fileset dir="${lib.dir}">
			<include name="cobertura.jar"/>
			<include name="asm-2.2.1.jar"/>
			<include name="jakarta-oro-2.0.8.jar"/>
			<include name="log4j-1.2.13.jar"/>
		</fileset>
	</path>
	<!-- Datasource-configuration-related properties -->
	<!-- Configuration files -->
	<property name="checkstyle.config" value="${resource.dir}/protexpress_checks.xml"/>
	<!-- Environment properties -->
	<property environment="env"/>
	<property file="${build.dir}/local.properties"/>
	<property file="${build.dir}/default.properties"/>
	<property name="tomcat.deploy.dir" value="${tomcat.home}/webapps"/>
	<filterset id="protexpress.filterset">
		<filtersfile file="${build.dir}/local.properties"/>
		<filtersfile file="${build.dir}/default.properties"/>
	</filterset>
	<!-- ******************************************************************* -->
	<!-- ** MAIN TARGETS                                                  ** -->
	<!-- ******************************************************************* -->
	<!-- *************** CLEAN TARGETS ***************************************-->
	<target name="clean:protexpress-common">
		<delete dir="${protexpress-common.target.dir}"/>
	</target>
	<target name="clean:protexpress-web">
		<delete dir="${protexpress-web.target.dir}"/>
	</target>
	<target name="clean:target.dir">
		<delete dir="${target.dir}"/>
	</target>
	<target name="clean" depends="clean:protexpress-common, clean:protexpress-web, clean:target.dir"/>
	<!-- *************** PREPARATION TARGETS ***************************************-->
	<target name="prepare:create-local.properties" unless="local.properties.exists" depends="prepare:check-for-local.properties">
		<touch file="${build.dir}/local.properties"/>
	</target>
	<target name="prepare:check-for-local.properties">
		<available file="${build.dir}/local.properties" property="local.properties.exists"/>
	</target>
	<!-- *************** COMPILE TARGETS ***************************************-->
	<target name="compile:protexpress-common">
		<mkdir dir="${protexpress-common.classes.dir}"/>
		<javac srcdir="${protexpress-common.src.dir}" destdir="${protexpress-common.classes.dir}" debug="true">
			<classpath>
				<pathelement location="${hibernate.jar}"/>
				<pathelement location="${commons-logging.jar}"/>
			</classpath>
		</javac>
	</target>
	<target name="compile:protexpress-web" depends="compile:protexpress-common">
		<mkdir dir="${protexpress-web.classes.dir}"/>
		<javac srcdir="${protexpress-web.src.dir}" destdir="${protexpress-web.classes.dir}" debug="true">
			<classpath>
				<pathelement location="${protexpress-common.classes.dir}"/>
				<pathelement location="${javaee.jar}"/>
				<pathelement location="${commons-lang.jar}"/>
				<pathelement location="${commons-logging.jar}"/>
				<pathelement location="${myfaces-api.jar}"/>
			</classpath>
		</javac>
	</target>
	<target name="compile" depends="compile:protexpress-common, compile:protexpress-web"/>
	<!-- *************** BUILD TARGETS ***************************************-->
	<target name="build:protexpress-common" depends="compile:protexpress-common">
		<mkdir dir="${protexpress-common.target.dir}"/>
		<jar destfile="${protexpress-common.jar}">
			<fileset dir="${protexpress-common.classes.dir}"/>
		</jar>
	</target>
	<target name="build:protexpress-web" depends="compile:protexpress-web">
		<mkdir dir="${protexpress-web.target.dir}"/>
		<war destfile="${protexpress.war}" webxml="${protexpress-web.webapp.dir}/WEB-INF/web.xml">
			<fileset dir="${protexpress-web.webapp.dir}">
				<exclude name="WEB-INF/**"/>
			</fileset>
			<webinf dir="${protexpress-web.webapp.dir}/WEB-INF">
				<exclude name="web.xml"/>
			</webinf>
			<classes dir="${protexpress-web.classes.dir}"/>
			<lib dir="${lib.dir}">
				<include name="commons-beanutils-1.7.0.jar"/>
				<include name="commons-codec-1.3.jar"/>
				<include name="commons-collections-3.1.jar"/>
				<include name="commons-digester-1.6.jar"/>
				<include name="commons-el-1.0.jar"/>
				<include name="commons-lang-2.1.jar"/>
				<include name="commons-logging-1.1.jar"/>
				<include name="myfaces-api-1.1.5.jar"/>
				<include name="myfaces-impl-1.1.5.jar"/>
			</lib>
		</war>
	</target>
	<target name="build" depends="build:protexpress-common, build:protexpress-web"/>
	<!-- *************** DEPLOY TARGETS ***************************************-->
	<target name="deploy" depends="build:protexpress-web, prepare:create-local.properties">
		<copy file="${protexpress-web.war}" todir="${tomcat.deploy.dir}"/>
	</target>
	
	
	 <target name="start-tomcat">
    <java jar="${tomcat.home}/bin/bootstrap.jar" fork="true">
        <jvmarg value="-Dcatalina.home=${tomcat.home}"/>
    </java>
</target>

<target name="stop-tomcat">
    <java jar="${tomcat.home}/bin/bootstrap.jar" fork="true">
        <jvmarg value="-Dcatalina.home=${tomcat.home}"/>
        <arg line="stop"/>
    </java>
</target>

	
	<!-- ******************************************************************* -->
	<!-- ******************************************************************* -->
	<!--
	<target name="continuous-integration" depends="clean, build, check, test:unit"/>
	<target name="nightly-build" depends="continuous-integration, deploy:start-jboss, deploy:deploy-and-wait, test:functional, deploy:stop-jboss, test:check-functional-test-results"/>
	
	-->
	<!-- ******************************************************************* -->
	<!-- ** BUILD TARGETS                                                 ** -->
	<!-- ******************************************************************* -->
	<!-- ******************************************************************* -->
	<!-- ** TEST TARGETS                                                  ** -->
	<!-- ******************************************************************* -->
	<!-- ******************************************************************* -->
	<!-- ** CHECK TARGETS                                                 ** -->
	<!-- ******************************************************************* -->
	<!-- ******************************************************************* -->
	<!-- ** SITE TARGETS                                                  ** -->
	<!-- ******************************************************************* -->
	<!-- ******************************************************************* -->
	<!-- ** DEPLOY TARGETS                                                ** -->
	<!-- ******************************************************************* -->
</project>
